# Halo CDN ç¼“å­˜åˆ·æ–°æ’ä»¶

ä¸€ä¸ªç”¨äº Halo 2.x çš„ CDN ç¼“å­˜è‡ªåŠ¨åˆ·æ–°æ’ä»¶ã€‚å½“æ–‡ç« /é¡µé¢å‘å¸ƒã€æ›´æ–°æˆ–è¯„è®ºå®¡æ ¸é€šè¿‡æ—¶ï¼Œè‡ªåŠ¨åˆ·æ–°å¯¹åº”é¡µé¢çš„ CDN ç¼“å­˜ã€‚æ”¯æŒ é˜¿é‡Œäº‘ã€è…¾è®¯äº‘ã€Cloudflareã€‚

å¯å¼€å¯å…¨ç«™ç¼“å­˜ï¼Œé…åˆæœ¬æ’ä»¶ä½¿ç”¨ï¼Œæå‡ç«™ç‚¹ç¼“å­˜çµæ´»æ€§ï¼Œå¹³è¡¡ç¼“å­˜å‘½ä¸­ç‡ä¸å†…å®¹å®æ—¶æ€§ã€‚

## åŠŸèƒ½ç‰¹æ€§
> è¯„è®ºæŒ‡çš„æ˜¯å®˜æ–¹è¯„è®ºç»„ä»¶ï¼Œç¬¬ä¸‰æ–¹è¯„è®ºå¦‚ Twikoo ä¸º JS åµŒå…¥ï¼Œæ— éœ€é¢å¤–æ”¯æŒã€‚
- ğŸš€ æ–‡ç« å‘å¸ƒ/æ›´æ–°æ—¶è‡ªåŠ¨åˆ·æ–° CDN ç¼“å­˜
- ğŸ“„ ç‹¬ç«‹é¡µé¢å‘å¸ƒ/æ›´æ–°æ—¶è‡ªåŠ¨åˆ·æ–°
- ğŸ’¬ è¯„è®ºå®¡æ ¸é€šè¿‡åè‡ªåŠ¨åˆ·æ–°å¯¹åº”é¡µé¢
- ğŸ”§ æ”¯æŒæ‰‹åŠ¨åˆ·æ–°æŒ‡å®š URL
- ğŸ“ åˆ·æ–°æ—¥å¿—è®°å½•ä¸æŸ¥çœ‹
- â±ï¸ URL é˜²æŠ–ï¼ˆ5ç§’å†…ç›¸åŒ URL åªåˆ·æ–°ä¸€æ¬¡ï¼‰

## æ”¯æŒçš„ CDN æä¾›å•†

| æä¾›å•† | ç±»å‹ | çŠ¶æ€ |
|--------|------|------|
| é˜¿é‡Œäº‘ CDN | ä¼ ç»Ÿ CDN | âœ… æ”¯æŒ |
| é˜¿é‡Œäº‘ ESA | è¾¹ç¼˜å®‰å…¨åŠ é€Ÿ | âœ… æ”¯æŒ |
| è…¾è®¯äº‘ CDN | ä¼ ç»Ÿ CDN | âœ… æ”¯æŒ |
| è…¾è®¯äº‘ EdgeOne | è¾¹ç¼˜å®‰å…¨åŠ é€Ÿ | âœ… æ”¯æŒ |
| Cloudflare | - | âœ… æ”¯æŒ |

## å®‰è£…

1. ä¸‹è½½æœ€æ–°ç‰ˆæœ¬çš„ JAR æ–‡ä»¶
2. åœ¨ Halo åå° -> æ’ä»¶ -> å®‰è£…æ’ä»¶ -> æœ¬åœ°ä¸Šä¼ 
3. å¯ç”¨æ’ä»¶

## é…ç½®è¯´æ˜

è¿›å…¥æ’ä»¶è®¾ç½®é¡µé¢è¿›è¡Œé…ç½®ã€‚

### åŸºæœ¬è®¾ç½®

| é…ç½®é¡¹ | è¯´æ˜ |
|--------|------|
| å¯ç”¨ CDN ç¼“å­˜åˆ·æ–° | æ€»å¼€å…³ |
| CDN æä¾›å•† | é€‰æ‹©ä½ ä½¿ç”¨çš„ CDN æœåŠ¡ |
| Access Key ID | é˜¿é‡Œäº‘/è…¾è®¯äº‘çš„ AccessKey ID |
| Access Key Secret | é˜¿é‡Œäº‘/è…¾è®¯äº‘çš„ AccessKey Secret |
| Cloudflare API Token | Cloudflare Token |
| Zone ID / Site ID | é˜¿é‡Œäº‘ ESA å¡« Site IDï¼Œè…¾è®¯äº‘ EdgeOne/Cloudflare å¡« Zone ID |
| ç«™ç‚¹åŸŸå | ä½ çš„ç«™ç‚¹åŸŸåï¼Œå¦‚ `https://example.com` |

### å„æä¾›å•†é…ç½®
**API éœ€è¦ç»™ CDN åˆ·æ–°æƒé™**

#### é˜¿é‡Œäº‘ CDN

- Access Key ID: é˜¿é‡Œäº‘ AccessKey ID
- Access Key Secret: é˜¿é‡Œäº‘ AccessKey Secret

#### é˜¿é‡Œäº‘ ESAï¼ˆè¾¹ç¼˜å®‰å…¨åŠ é€Ÿï¼‰

- Access Key ID: é˜¿é‡Œäº‘ AccessKey ID
- Access Key Secret: é˜¿é‡Œäº‘ AccessKey Secret
- Zone ID / Site ID: ESA ç«™ç‚¹ IDï¼ˆåœ¨ ESA æ§åˆ¶å°æŸ¥çœ‹ï¼‰

#### è…¾è®¯äº‘ CDN

- Access Key ID: è…¾è®¯äº‘ SecretId
- Access Key Secret: è…¾è®¯äº‘ SecretKey

#### è…¾è®¯äº‘ EdgeOne

- Access Key ID: è…¾è®¯äº‘ SecretId
- Access Key Secret: è…¾è®¯äº‘ SecretKey
- Zone ID / Site ID: EdgeOne ç«™ç‚¹ ID

#### Cloudflare

- Cloudflare API Token: API Tokenï¼ˆéœ€è¦ `Zone.Cache Purge` æƒé™ï¼‰
- Zone ID / Site ID: Zone IDï¼ˆåœ¨ Cloudflare æ§åˆ¶å°åŸŸåæ¦‚è§ˆé¡µå³ä¾§æŸ¥çœ‹ï¼‰

åˆ›å»º Cloudflare API Tokenï¼š
1. ç™»å½• Cloudflare Dashboard
2. My Profile -> API Tokens -> Create Token
3. ä½¿ç”¨ "Purge Cache" æ¨¡æ¿æˆ–è‡ªå®šä¹‰æƒé™
4. Zone Resources é€‰æ‹©å¯¹åº”åŸŸå

### åˆ·æ–°é€‰é¡¹

| é…ç½®é¡¹ | è¯´æ˜ | é»˜è®¤å€¼ |
|--------|------|--------|
| åˆ·æ–°é¦–é¡µ | æ–‡ç« å‘å¸ƒæ—¶åˆ·æ–°é¦–é¡µ | å¼€å¯ |
| åˆ·æ–°å½’æ¡£é¡µ | æ–‡ç« å‘å¸ƒæ—¶åˆ·æ–°å½’æ¡£é¡µ | å¼€å¯ |
| åˆ·æ–°åˆ†ç±»é¡µ | æ–‡ç« å‘å¸ƒæ—¶åˆ·æ–°åˆ†ç±»é¡µ | å¼€å¯ |
| åˆ·æ–°æ ‡ç­¾é¡µ | æ–‡ç« å‘å¸ƒæ—¶åˆ·æ–°æ ‡ç­¾é¡µ | å¼€å¯ |
| è¯„è®ºååˆ·æ–° | è¯„è®ºå®¡æ ¸é€šè¿‡ååˆ·æ–°é¡µé¢ | å¼€å¯ |
| è‡ªå®šä¹‰åˆ·æ–°è·¯å¾„ | é¢å¤–åˆ·æ–°çš„è·¯å¾„ï¼Œé€—å·åˆ†éš” | - |

### è·¯ç”±è®¾ç½®

å¦‚æœä½ ä¿®æ”¹äº† Halo çš„é»˜è®¤è·¯ç”±ï¼Œéœ€è¦åœ¨è¿™é‡ŒåŒæ­¥é…ç½®ï¼š

| é…ç½®é¡¹ | é»˜è®¤å€¼ |
|--------|--------|
| å½’æ¡£é¡µè·¯ç”± | archives |
| åˆ†ç±»é¡µè·¯ç”± | categories |
| æ ‡ç­¾é¡µè·¯ç”± | tags |

## åˆ·æ–°æ—¥å¿—

åœ¨æ’ä»¶è®¾ç½®é¡µé¢çš„ã€Œåˆ·æ–°æ—¥å¿—ã€æ ‡ç­¾é¡µå¯ä»¥ï¼š

- æŸ¥çœ‹åˆ·æ–°å†å²è®°å½•
- æ‰‹åŠ¨åˆ·æ–°æŒ‡å®š URL
- æ¸…ç©ºæ—¥å¿—

## è§¦å‘æ—¶æœº

| äº‹ä»¶ | åˆ·æ–°å†…å®¹ |
|------|----------|
| æ–‡ç« å‘å¸ƒ | æ–‡ç« é¡µã€é¦–é¡µã€å½’æ¡£é¡µã€åˆ†ç±»é¡µã€æ ‡ç­¾é¡µã€è‡ªå®šä¹‰è·¯å¾„ |
| æ–‡ç« æ›´æ–° | æ–‡ç« é¡µã€é¦–é¡µã€å½’æ¡£é¡µã€åˆ†ç±»é¡µã€æ ‡ç­¾é¡µã€è‡ªå®šä¹‰è·¯å¾„ |
| é¡µé¢å‘å¸ƒ/æ›´æ–° | é¡µé¢ URLã€é¦–é¡µã€è‡ªå®šä¹‰è·¯å¾„ |
| è¯„è®ºå®¡æ ¸é€šè¿‡ | å¯¹åº”æ–‡ç« /é¡µé¢ URL |

## æ³¨æ„äº‹é¡¹

1. ç¡®ä¿ Halo åå°çš„ã€Œç«™ç‚¹åœ°å€ã€é…ç½®æ­£ç¡®ï¼Œæ’ä»¶ä¼šä½¿ç”¨è¯¥åœ°å€æ„å»ºåˆ·æ–° URL
2. CDN åˆ·æ–°æœ‰é¢‘ç‡é™åˆ¶ï¼Œè¯·å‹¿é¢‘ç¹æ“ä½œï¼Œå…·ä½“è¯·å‚è€ƒå„ CDN æä¾›å•†æ–‡æ¡£
3. åŒä¸€ URL åœ¨ 5 ç§’å†…åªä¼šåˆ·æ–°ä¸€æ¬¡ï¼ˆé˜²æŠ–ï¼‰

## æ•ˆæœæˆªå›¾
> å…¨ç«™éƒ½ä½¿ç”¨ CDN è¿›è¡Œç¼“å­˜äº†ï¼Œé™¤äº† /console/\*, /api/\* è¿™äº›è·¯ç”±ã€‚
### æ’ä»¶å¼€å¯å‰
![ITdog æµ‹é€Ÿ](screenshots/img_0.png)
![DevTool å“åº”](screenshots/img_2.png)
### æ’ä»¶å¼€å¯å
![ITdog æµ‹é€Ÿ](screenshots/img_1.png)
![DevTool å“åº”](screenshots/img_3.png)

## å¼€å‘

```bash
# æ„å»º
./gradlew build

# è·³è¿‡æµ‹è¯•æ„å»º
./gradlew build -x test
```

## è®¸å¯è¯

[GPL-3.0](LICENSE)

## ä½œè€…

[SwaggyMacro](https://github.com/SwaggyMacro)
